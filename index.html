<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <title>p5.js Responsive Example</title>
  <style>
    img {
      display: block;
      position: absolute;
    }
    .emotion-label {
      font-family: 'Arial', sans-serif; 
      font-size: 16px;
      text-align: center;
      color: #333;
      position: absolute;
      width: 100px;
    }
  </style>
</head>
<body>
  <script>
    let backgroundImages = [];
    let motifImages = [];
    let countJoy = 0, countTrust = 0, countFear = 0, countSurprise = 0, countSadness = 0, countDisgust = 0, countAnger = 0, countAnticipation = 0, countEcstasy = 0, countAdoration = 0, countTerror = 0, countAmazement = 0, countGrief = 0, countLoathing = 0, countRage = 0, countVigilance = 0;
    let countSerenity = 0, countAcceptance = 0, countApprehension = 0, countDistraction = 0, countPensiveness = 0, countBoredom = 0, countAnnoyance = 0, countInterest = 0;

    let emotionsA = ['joy', 'trust', 'fear', 'surprise', 'sadness', 'disgust', 'anger', 'anticipation'];
    let emotionsB = ['ecstasy', 'adoration', 'terror', 'amazement', 'grief', 'loathing', 'rage', 'vigilance'];
    let emotionsC = ['serenity', 'acceptance', 'apprehension', 'distraction', 'pensiveness', 'boredom', 'annoyance', 'interest'];
    
    let radiusA, radiusB, radiusC;
    let emotionSize;

    let selectedBackground, selectedMotif;
    let buttons = {};
    let labels = {};
    
    let sparkles = [];
    let sparkleDuration = 2000; // キラキラの表示時間
    let sparkleColors = {
      'Joy': '#B50000',
      'Trust': '#E58351',
      'Fear': '#FFD036',
      'Surprise': '#36C238',
      'Sadness': '#008704',
      'Disgust': '#5D94A6',
      'Anger': '#00699D',
      'Anticipation': '#FF7CC0',
      'Ecstasy': '#7F0000',
      'Adoration': '#B2653E',
      'Terror': '#CCA32A',
      'Amazement': '#003A00',
      'Grief': '#00496B',
      'Loathing': '#406672',
      'Rage': '#278E27',
      'Vigilance': '#CC6399',
      'Serenity': '#E50000',
      'Acceptance': '#FF7F3F',
      'Apprehension': '#FF8F00',
      'Distraction': '#00BA03',
      'Pensiveness': '#008ED1',
      'Boredom': '#7FCBE2',
      'Annoyance': '#B2E4B2',
      'Interest': '#FF7CC0'
    };

    function preload() {
      // 背景画像の読み込み
      backgroundImages[0] = loadImage('https://mooo0ooo.github.io/diary/background1.png');
      backgroundImages[1] = loadImage('https://mooo0ooo.github.io/diary/background2.png');
      backgroundImages[2] = loadImage('https://mooo0ooo.github.io/diary/background3.png');
      backgroundImages[3] = loadImage('https://mooo0ooo.github.io/diary/background4.png');

      // モチーフ画像の読み込み
      motifImages['Joy'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/fireworks-removebg-preview.png');
      motifImages['Trust'] = loadImage('https://mooo0ooo.github.io/diary/sun-removebg-preview.png'); 
      motifImages['Fear'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/moon-removebg-preview.png');
      motifImages['Surprise'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/thunder.PNG');
      motifImages['Sadness'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/shooting_star-removebg-preview.png');
      motifImages['Disgust'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/rain.PNG');
      motifImages['Anger'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/star-removebg-preview.png');
      motifImages['Anticipation'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/balloon.PNG');

      motifImages['Ecstasy'] = loadImage('https://mooo0ooo.github.io/diary/rose.PNG');
      motifImages['Adoration'] = loadImage('https://mooo0ooo.github.io/diary/tulip.PNG');
      motifImages['Terror'] = loadImage('https://mooo0ooo.github.io/diary/yellowFlower.PNG');
      motifImages['Amazement'] = loadImage('https://mooo0ooo.github.io/diary/clover.PNG');
      motifImages['Grief'] = loadImage('https://mooo0ooo.github.io/diary/futaba.PNG');
      motifImages['Loathing'] = loadImage('https://mooo0ooo.github.io/diary/mizuiroFlower.PNG');
      motifImages['Rage'] = loadImage('https://mooo0ooo.github.io/diary/blueFlower.PNG');
      motifImages['Vigilance'] = loadImage('https://mooo0ooo.github.io/diary/cherryBlossom.PNG');

      motifImages['Serenity'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/apple.PNG');  
    　motifImages['Acceptance'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/carrot.PNG'); 
      motifImages['Apprehension'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/egg.PNG');
      motifImages['Distraction'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/avocado.PNG');
      motifImages['Pensiveness'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/broccoli.PNG');
      motifImages['Boredom'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/turnip.PNG');
      motifImages['Annoyance'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/fork.PNG');
      motifImages['Interest'] = loadImage('https://raw.githubusercontent.com/mooo0ooo/diary/main/glove.PNG');

    }

    function setup() {
      createCanvas(windowWidth, windowHeight);
      calculateSizes();

      // 感情のボタンを画像として作成
      buttons.joy = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/fireworks-removebg-preview.png', 'Joy').mousePressed(() => { handleEmotionButton('Joy'); });
      buttons.trust = createImg('https://mooo0ooo.github.io/diary/sun-removebg-preview.png', 'Trust').mousePressed(() => { handleEmotionButton('Trust'); });
      buttons.fear = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/moon-removebg-preview.png', 'Fear').mousePressed(() => { handleEmotionButton('Fear'); });
      buttons.surprise = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/thunder.PNG', 'Surprise').mousePressed(() => { handleEmotionButton('Surprise'); });
      buttons.sadness = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/shooting_star-removebg-preview.png', 'Sadness').mousePressed(() => { handleEmotionButton('Sadness'); });
      buttons.disgust = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/rain.PNG', 'Disgust').mousePressed(() => { handleEmotionButton('Disgust'); });
      buttons.anger = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/star-removebg-preview.png', 'Anger').mousePressed(() => { handleEmotionButton('Anger'); });
      buttons.anticipation = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/balloon.PNG', 'Anticipation').mousePressed(() => { handleEmotionButton('Anticipation'); });

      buttons.ecstasy = createImg('https://mooo0ooo.github.io/diary/rose.PNG', 'Ecstasy').mousePressed(() => { handleEmotionButton('Ecstasy'); });
      buttons.adoration = createImg('https://mooo0ooo.github.io/diary/tulip.PNG', 'Adoration').mousePressed(() => { handleEmotionButton('Adoration'); });
      buttons.terror = createImg('https://mooo0ooo.github.io/diary/yellowFlower.PNG', 'Terror').mousePressed(() => { handleEmotionButton('Terror'); });
      buttons.amazement = createImg('https://mooo0ooo.github.io/diary/clover.PNG', 'Amazement').mousePressed(() => { handleEmotionButton('Amazement'); });
      buttons.grief = createImg('https://mooo0ooo.github.io/diary/futaba.PNG', 'Grief').mousePressed(() => { handleEmotionButton('Grief'); });
      buttons.loathing = createImg('https://mooo0ooo.github.io/diary/mizuiroFlower.PNG', 'Loathing').mousePressed(() => { handleEmotionButton('Loathing'); });
      buttons.rage = createImg('https://mooo0ooo.github.io/diary/blueFlower.PNG', 'Rage').mousePressed(() => { handleEmotionButton('Rage'); });
      buttons.vigilance = createImg('https://mooo0ooo.github.io/diary/cherryBlossom.PNG', 'Vigilance').mousePressed(() => { handleEmotionButton('Vigilance'); });

      buttons.serenity = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/apple.PNG', 'Serenity').mousePressed(() => { handleEmotionButton('Serenity'); });
      buttons.acceptance = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/carrot.PNG', 'Acceptance').mousePressed(() => { handleEmotionButton('Acceptance'); });
      buttons.apprehension = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/egg.PNG', 'Apprehension').mousePressed(() => { handleEmotionButton('Apprehension'); });
      buttons.distraction = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/avocado.PNG', 'Distraction').mousePressed(() => { handleEmotionButton('Distraction'); });
      buttons.pensiveness = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/broccoli.PNG', 'Pensiveness').mousePressed(() => { handleEmotionButton('Pensiveness'); });
      buttons.boredom = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/turnip.PNG', 'Boredom').mousePressed(() => { handleEmotionButton('Boredom'); });
      buttons.annoyance = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/fork.PNG', 'Annoyance').mousePressed(() => { handleEmotionButton('Annoyance'); });
      buttons.interest = createImg('https://raw.githubusercontent.com/mooo0ooo/diary/main/glove.PNG', 'Interest').mousePressed(() => { handleEmotionButton('Interest'); });
      
      // 各ボタンの位置とラベルの設定
      let xOffset = 20;
      let yOffset = 20;
      let buttonSize = 80;
      let gap = 10;

      for (let emotion in buttons) {
        buttons[emotion].size(buttonSize, buttonSize);
        buttons[emotion].position(xOffset, yOffset);

        labels[emotion] = createDiv(emotion);
        labels[emotion].position(xOffset, yOffset + buttonSize);
        labels[emotion].class('emotion-label');

        xOffset += buttonSize + gap;
        if (xOffset > windowWidth - buttonSize) {
          xOffset = 20;
          yOffset += buttonSize + 40;
        }
      }
    }

    function draw() {
      clear();
      background(255); // 白背景
      translate(width / 2, height / 2);

      drawEmotionCircle(emotionsA, radiusA);
      drawEmotionCircle(emotionsB, radiusB);
      drawEmotionCircle(emotionsC, radiusC);

      // キラキラ効果の描画
      for (let i = sparkles.length - 1; i >= 0; i--) {
        let sparkle = sparkles[i];
        if (millis() - sparkle.startTime > sparkleDuration) {
          sparkles.splice(i, 1); // キラキラが2秒以上経ったら消去
        } else {
          drawSparkle(sparkle);
        }
      }

      // 選択された背景画像とモチーフ画像の表示
      if (selectedBackground) {
        image(selectedBackground, 0, 0, windowWidth, windowHeight);
      }

      if (selectedMotif) {
        image(selectedMotif, windowWidth / 2 - 100, windowHeight / 2 - 100, 200, 200);
      }
    }

    function drawEmotionCircle(emotions, radius) {
  let angleStep = TWO_PI / emotions.length;

  for (let i = 0; i < emotions.length; i++) {
    let angle = i * angleStep;
    let x = cos(angle) * radius;
    let y = sin(angle) * radius;
    
    // ラベルの表示
    fill(0);
    textAlign(CENTER, CENTER);
    textSize(emotionSize);
    text(emotions[i], x, y - emotionSize / 2);
    
    // 丸の画像の代わりに円を描画
    fill(200);
    ellipse(x, y, emotionSize, emotionSize);
  }
}

function calculateSizes() {
  // デバイスに基づくサイズ調整
  let minDim = min(windowWidth, windowHeight);
  
  radiusA = minDim * 0.15; // 内側の円
  radiusB = minDim * 0.3;  // 中間の円
  radiusC = minDim * 0.45; // 外側の円
  emotionSize = minDim * 0.05; // 感情ラベルと円のサイズ
}

    function handleEmotionButton(emotion) {
      // 背景画像とモチーフ画像の設定
      selectedBackground = random(backgroundImages);
      selectedMotif = motifImages[emotion];

      // キラキラ効果の生成
      for (let i = 0; i < 10; i++) { // キラキラの数を減らした
        sparkles.push(createSparkle(emotion));
      }
    }

    function createSparkle(emotion) {
      return {
        x: random(windowWidth),
        y: random(windowHeight),
        size: random(5, 20), // サイズを1/10に縮小
        color: sparkleColors[emotion],
        filled: random() > 0.5, // ランダムに塗りつぶしあり/なし
        shape: random(['circle', 'star', 'hexagon', 'diamond']), // ランダムな形
        startTime: millis()
      };
    }

    function drawSparkle(sparkle) {
      push();
      noStroke();
      fill(sparkle.color);
      if (!sparkle.filled) {
        noFill();
        stroke(sparkle.color); // アウトラインの色を変更
      }

      translate(sparkle.x, sparkle.y);
      let halfSize = sparkle.size / 2;

      // 各形状を描画
      switch (sparkle.shape) {
        case 'circle':
          ellipse(0, 0, sparkle.size);
          break;
        case 'star':
          drawStar(halfSize, halfSize * 0.5);
          break;
        case 'hexagon':
          drawPolygon(6, halfSize);
          break;
        case 'diamond':
          rotate(PI / 4);
          rect(0, 0, sparkle.size, sparkle.size);
          break;
      }
      pop();
    }

    function drawStar(radius1, radius2) {
      beginShape();
      for (let i = 0; i < 10; i++) {
        let angle = TWO_PI / 10 * i;
        let r = i % 2 === 0 ? radius1 : radius2;
        let x = cos(angle) * r;
        let y = sin(angle) * r;
        vertex(x, y);
      }
      endShape(CLOSE);
    }

    function drawPolygon(npoints, radius) {
      beginShape();
      for (let a = 0; a < TWO_PI; a += TWO_PI / npoints) {
        let sx = cos(a) * radius;
        let sy = sin(a) * radius;
        vertex(sx, sy);
      }
      endShape(CLOSE);
    }

    function windowResized() {
      resizeCanvas(windowWidth, windowHeight);
      calculateSizes();
    }
  </script>
</body>
</html>

